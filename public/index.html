<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£—á—ë—Ç –æ–ø–µ—Ä–∞—Ü–∏–π –ø–æ –∫–∞—Ä—Ç–µ</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1a1a1a;
            color: #e0e0e0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            background: #2d2d2d;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.4);
            padding: 20px;
        }

        .login-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 80vh;
            text-align: center;
        }

        .login-screen h2 {
            margin-bottom: 20px;
            color: #e0e0e0;
        }

        .login-screen p {
            margin-bottom: 30px;
            color: #b0b0b0;
        }

        .user-info {
            background: #3a3a3a;
            padding: 12px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 15px;
        }

        .user-info .user-details {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .user-info img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
        }

        .user-info .user-name {
            color: #e0e0e0;
            font-weight: 500;
        }

        .logout-btn {
            background: #d32f2f;
            padding: 8px 16px;
            font-size: 14px;
            margin: 0;
        }

        .logout-btn:hover {
            background: #b71c1c;
        }

        .hidden {
            display: none;
        }

        h1 {
            text-align: center;
            color: #e0e0e0;
            margin-bottom: 25px;
            font-size: 1.8em;
            font-weight: 600;
        }

        .summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px;
            margin-bottom: 25px;
        }

        .summary-card {
            padding: 18px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #4a4a4a;
            background: #3a3a3a;
        }

        .summary-card.income {
            background: #1b3a1b;
            border-color: #2e7d32;
        }

        .summary-card.spent {
            background: #3a1b1b;
            border-color: #c62828;
        }

        .summary-card.buyback {
            background: #1b2a3a;
            border-color: #1976d2;
        }

        .summary-card.earned {
            background: #3a2e1b;
            border-color: #f57c00;
        }

        .summary-card h3 {
            font-size: 0.85em;
            margin-bottom: 8px;
            color: #b0b0b0;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .summary-card .amount {
            font-size: 1.6em;
            font-weight: 700;
            color: #e0e0e0;
        }

        .table-wrapper {
            overflow-x: auto;
            margin-top: 20px;
            border-radius: 8px;
            border: 1px solid #4a4a4a;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 900px;
        }

        th {
            background: #3a3a3a;
            color: #e0e0e0;
            padding: 14px 10px;
            text-align: left;
            font-weight: 500;
            font-size: 0.9em;
            white-space: nowrap;
            border-bottom: 2px solid #4a4a4a;
        }

        td {
            padding: 10px;
            border-bottom: 1px solid #3a3a3a;
            background: #2d2d2d;
        }

        tr:hover td {
            background-color: #353535;
        }

        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #4a4a4a;
            border-radius: 4px;
            font-size: 14px;
            transition: border-color 0.2s;
            background: #1a1a1a;
            color: #e0e0e0;
        }

        input[type="text"]:focus, input[type="number"]:focus {
            outline: none;
            border-color: #5c6bc0;
            box-shadow: 0 0 0 2px rgba(92, 107, 192, 0.2);
        }

        .calculated {
            background-color: #3a3a3a;
            font-weight: 600;
            color: #90caf9;
            text-align: center;
        }

        button {
            background: #5c6bc0;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 15px;
            margin-top: 20px;
            transition: background 0.2s;
            font-weight: 500;
        }

        button:hover {
            background: #3949ab;
        }

        .delete-btn {
            background: #d32f2f;
            padding: 6px 12px;
            font-size: 13px;
            margin: 0;
        }

        .delete-btn:hover {
            background: #b71c1c;
        }

        .mobile-card {
            display: none;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .container {
                padding: 15px;
            }

            h1 {
                font-size: 1.4em;
                margin-bottom: 20px;
            }

            .summary {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }

            .summary-card {
                padding: 12px;
            }

            .summary-card h3 {
                font-size: 0.75em;
            }

            .summary-card .amount {
                font-size: 1.3em;
            }

            .table-wrapper {
                display: none;
            }

            .mobile-card {
                display: block;
                background: #2d2d2d;
                border: 1px solid #4a4a4a;
                border-radius: 8px;
                padding: 15px;
                margin-bottom: 15px;
            }

            .mobile-card-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 15px;
                padding-bottom: 10px;
                border-bottom: 1px solid #4a4a4a;
            }

            .mobile-card-header h3 {
                color: #90caf9;
                font-size: 1.1em;
                margin: 0;
            }

            .mobile-card-row {
                display: flex;
                justify-content: space-between;
                margin-bottom: 10px;
            }

            .mobile-card-row label {
                color: #b0b0b0;
                font-size: 0.9em;
            }

            .mobile-card-row input {
                width: 60%;
                padding: 6px;
                font-size: 13px;
            }

            .mobile-card-result {
                background: #3a3a3a;
                padding: 10px;
                border-radius: 6px;
                margin-top: 10px;
                text-align: center;
            }

            .mobile-card-result .label {
                color: #b0b0b0;
                font-size: 0.85em;
                margin-bottom: 5px;
            }

            .mobile-card-result .value {
                color: #90caf9;
                font-size: 1.3em;
                font-weight: 600;
            }

            button {
                width: 100%;
                padding: 12px;
            }

            .delete-btn {
                padding: 8px 16px;
                font-size: 13px;
                width: auto;
            }

            .user-info {
                flex-direction: column;
                text-align: center;
            }

            .user-info .user-details {
                flex-direction: column;
            }
        }

        @media (max-width: 480px) {
            .summary {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="loginScreen" class="login-screen">
            <h2>üí≥ –£—á—ë—Ç –æ–ø–µ—Ä–∞—Ü–∏–π –ø–æ –∫–∞—Ä—Ç–µ</h2>
            <p>–î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã –æ—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram</p>
            <a href="https://t.me/flyer_amnyam_bot" target="_blank">
                <button style="background: #0088cc; padding: 15px 30px; font-size: 16px; margin-top: 20px;">
                    üì± –û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞ @flyer_amnyam_bot
                </button>
            </a>
            <p style="margin-top: 20px; font-size: 0.9em; color: #888;">
                –ù–∞–∂–º–∏—Ç–µ /start –≤ –±–æ—Ç–µ, –∑–∞—Ç–µ–º –∫–Ω–æ–ø–∫—É "–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"
            </p>
        </div>

        <div id="appContent" class="hidden">
            <h1>üí≥ –£—á—ë—Ç –æ–ø–µ—Ä–∞—Ü–∏–π –ø–æ –∫–∞—Ä—Ç–µ</h1>
            
            <div class="user-info">
                <div class="user-details">
                    <img id="userPhoto" src="" alt="User">
                    <span class="user-name" id="userName"></span>
                </div>
                <button class="logout-btn" onclick="logout()">–í—ã–π—Ç–∏</button>
            </div>
        
            <div class="summary">
                <div class="summary-card income">
                    <h3>–í—Ö–æ–¥</h3>
                    <div class="amount" id="totalIncome">0 ‚ÇΩ</div>
                </div>
                <div class="summary-card spent">
                    <h3>–ü–æ—Ç—Ä–∞—á–µ–Ω–æ</h3>
                    <div class="amount" id="totalSpent">0 ‚ÇΩ</div>
                </div>
                <div class="summary-card buyback">
                    <h3>–í—ã—Ö–æ–¥</h3>
                    <div class="amount" id="totalBuyback">0 ‚ÇΩ</div>
                </div>
                <div class="summary-card earned">
                    <h3>–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</h3>
                    <div class="amount" id="totalEarned">0 ‚ÇΩ</div>
                </div>
            </div>

            <div class="table-wrapper">
                <table id="transactionTable">
                    <thead>
                        <tr>
                            <th>–†–µ–∫–≤–∏–∑–∏—Ç</th>
                            <th>–í—Ö–æ–¥ (‚ÇΩ)</th>
                            <th>% –∑–∞—Ä–∞–±–æ—Ç–∫–∞</th>
                            <th>–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ —Å –≤—Ö–æ–¥–∞ (‚ÇΩ)</th>
                            <th>–ü–æ—Ç—Ä–∞—á–µ–Ω–æ (‚ÇΩ)</th>
                            <th>–í—ã—Ö–æ–¥ (‚ÇΩ)</th>
                            <th>% –æ—Ç–∫—É–ø–∞</th>
                            <th>–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ —Å –≤—ã—Ö–æ–¥–∞ (‚ÇΩ)</th>
                            <th>–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ (‚ÇΩ)</th>
                            <th>–î–µ–π—Å—Ç–≤–∏–µ</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                    </tbody>
                </table>
            </div>

            <div id="mobileCards"></div>

            <button onclick="addRow()">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É</button>
        </div>
    </div>

    <script>
        let rowCounter = 0;
        let currentUser = null;
        let userData = null;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        let tg = window.Telegram.WebApp;
        
        function initTelegramAuth() {
            if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
                const user = tg.initDataUnsafe.user;
                onTelegramAuth(user);
                tg.expand();
                tg.ready();
            } else {
                checkAuth();
            }
        }

        function onTelegramAuth(user) {
            userData = user;
            currentUser = 'tg_' + user.id;
            
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('appContent').classList.remove('hidden');
            
            document.getElementById('userName').textContent = user.first_name + (user.last_name ? ' ' + user.last_name : '');
            
            if (user.photo_url) {
                document.getElementById('userPhoto').src = user.photo_url;
            } else {
                document.getElementById('userPhoto').src = 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23666"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>';
            }
            
            localStorage.setItem('telegramUser', JSON.stringify(user));
            loadData();
        }

        function logout() {
            localStorage.removeItem('telegramUser');
            currentUser = null;
            userData = null;
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('appContent').classList.add('hidden');
            document.getElementById('tableBody').innerHTML = '';
            document.getElementById('mobileCards').innerHTML = '';
        }

        function checkAuth() {
            const savedUser = localStorage.getItem('telegramUser');
            if (savedUser) {
                const user = JSON.parse(savedUser);
                onTelegramAuth(user);
            }
        }

        function addRow() {
            rowCounter++;
            const tbody = document.getElementById('tableBody');
            const row = tbody.insertRow();
            row.id = `row-${rowCounter}`;
            
            row.innerHTML = `
                <td><input type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ä–µ–∫–≤–∏–∑–∏—Ç" onchange="saveData()"></td>
                <td><input type="number" value="0" min="0" step="0.01" onchange="calculate(${rowCounter})"></td>
                <td><input type="number" value="11" min="0" max="100" step="0.01" onchange="calculate(${rowCounter})"></td>
                <td class="calculated">0.00</td>
                <td><input type="number" value="0" min="0" step="0.01" onchange="calculate(${rowCounter})"></td>
                <td><input type="number" value="0" min="0" step="0.01" onchange="calculate(${rowCounter})"></td>
                <td><input type="number" value="1" min="0" max="100" step="0.01" onchange="calculate(${rowCounter})"></td>
                <td class="calculated">0.00</td>
                <td class="calculated">0.00</td>
                <td><button class="delete-btn" onclick="deleteRow(${rowCounter})">–£–¥–∞–ª–∏—Ç—å</button></td>
            `;
            
            createMobileCard(rowCounter);
            calculate(rowCounter);
            saveData();
        }

        function createMobileCard(rowId) {
            const mobileCards = document.getElementById('mobileCards');
            const card = document.createElement('div');
            card.className = 'mobile-card';
            card.id = `mobile-card-${rowId}`;
            
            card.innerHTML = `
                <div class="mobile-card-header">
                    <h3>–û–ø–µ—Ä–∞—Ü–∏—è #${rowId}</h3>
                    <button class="delete-btn" onclick="deleteRow(${rowId})">–£–¥–∞–ª–∏—Ç—å</button>
                </div>
                <div class="mobile-card-row">
                    <label>–†–µ–∫–≤–∏–∑–∏—Ç:</label>
                    <input type="text" placeholder="–†–µ–∫–≤–∏–∑–∏—Ç" onchange="syncToTable(${rowId}, 0, this.value); saveData()">
                </div>
                <div class="mobile-card-row">
                    <label>–í—Ö–æ–¥ (‚ÇΩ):</label>
                    <input type="number" value="0" min="0" step="0.01" onchange="syncToTable(${rowId}, 1, this.value); calculate(${rowId})">
                </div>
                <div class="mobile-card-row">
                    <label>% –∑–∞—Ä–∞–±–æ—Ç–∫–∞:</label>
                    <input type="number" value="11" min="0" max="100" step="0.01" onchange="syncToTable(${rowId}, 2, this.value); calculate(${rowId})">
                </div>
                <div class="mobile-card-row">
                    <label>–ü–æ—Ç—Ä–∞—á–µ–Ω–æ (‚ÇΩ):</label>
                    <input type="number" value="0" min="0" step="0.01" onchange="syncToTable(${rowId}, 4, this.value); calculate(${rowId})">
                </div>
                <div class="mobile-card-row">
                    <label>–í—ã—Ö–æ–¥ (‚ÇΩ):</label>
                    <input type="number" value="0" min="0" step="0.01" onchange="syncToTable(${rowId}, 5, this.value); calculate(${rowId})">
                </div>
                <div class="mobile-card-row">
                    <label>% –æ—Ç–∫—É–ø–∞:</label>
                    <input type="number" value="1" min="0" max="100" step="0.01" onchange="syncToTable(${rowId}, 6, this.value); calculate(${rowId})">
                </div>
                <div class="mobile-card-result">
                    <div class="label">–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</div>
                    <div class="value" id="mobile-earned-${rowId}">0.00 ‚ÇΩ</div>
                </div>
            `;
            
            mobileCards.appendChild(card);
        }

        function syncToTable(rowId, cellIndex, value) {
            const row = document.getElementById(`row-${rowId}`);
            if (row) {
                const input = row.cells[cellIndex].querySelector('input');
                if (input) {
                    input.value = value;
                }
            }
        }

        function calculate(rowId) {
            const row = document.getElementById(`row-${rowId}`);
            if (!row) return;
            
            const cells = row.cells;
            const income = parseFloat(cells[1].querySelector('input').value) || 0;
            const incomePercent = parseFloat(cells[2].querySelector('input').value) || 0;
            const spent = parseFloat(cells[4].querySelector('input').value) || 0;
            const buyback = parseFloat(cells[5].querySelector('input').value) || 0;
            const buybackPercent = parseFloat(cells[6].querySelector('input').value) || 0;
            
            const earnedFromIncome = (income * incomePercent) / 100;
            const earnedFromBuyback = (buyback * buybackPercent) / 100;
            const totalEarned = earnedFromIncome + earnedFromBuyback - spent;
            
            cells[3].textContent = earnedFromIncome.toFixed(2);
            cells[7].textContent = earnedFromBuyback.toFixed(2);
            cells[8].textContent = totalEarned.toFixed(2);
            
            const mobileEarned = document.getElementById(`mobile-earned-${rowId}`);
            if (mobileEarned) {
                mobileEarned.textContent = totalEarned.toFixed(2) + ' ‚ÇΩ';
            }
            
            updateSummary();
            saveData();
        }

        function updateSummary() {
            let totalIncome = 0;
            let totalSpent = 0;
            let totalBuyback = 0;
            let totalEarnedFromIncome = 0;
            let totalEarnedFromBuyback = 0;
            
            const rows = document.getElementById('tableBody').rows;
            for (let row of rows) {
                const cells = row.cells;
                totalIncome += parseFloat(cells[1].querySelector('input').value) || 0;
                totalSpent += parseFloat(cells[4].querySelector('input').value) || 0;
                totalBuyback += parseFloat(cells[5].querySelector('input').value) || 0;
                totalEarnedFromIncome += parseFloat(cells[3].textContent) || 0;
                totalEarnedFromBuyback += parseFloat(cells[7].textContent) || 0;
            }
            
            const totalEarned = totalEarnedFromIncome + totalEarnedFromBuyback - totalSpent;
            
            document.getElementById('totalIncome').textContent = totalIncome.toFixed(2) + ' ‚ÇΩ';
            document.getElementById('totalSpent').textContent = totalSpent.toFixed(2) + ' ‚ÇΩ';
            document.getElementById('totalBuyback').textContent = totalBuyback.toFixed(2) + ' ‚ÇΩ';
            document.getElementById('totalEarned').textContent = totalEarned.toFixed(2) + ' ‚ÇΩ';
        }

        function deleteRow(rowId) {
            const row = document.getElementById(`row-${rowId}`);
            const mobileCard = document.getElementById(`mobile-card-${rowId}`);
            
            if (row) {
                row.remove();
            }
            if (mobileCard) {
                mobileCard.remove();
            }
            
            updateSummary();
            saveData();
        }

        async function saveData() {
            if (!currentUser) return;
            
            const rows = document.getElementById('tableBody').rows;
            const data = [];
            
            for (let row of rows) {
                const cells = row.cells;
                const inputs = row.querySelectorAll('input');
                data.push({
                    id: row.id,
                    requisite: inputs[0].value,
                    income: inputs[1].value,
                    incomePercent: inputs[2].value,
                    spent: inputs[3].value,
                    buyback: inputs[4].value,
                    buybackPercent: inputs[5].value
                });
            }
            
            try {
                await fetch(`/api/data/${currentUser}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        rows: data,
                        rowCounter: rowCounter,
                        userData: userData
                    })
                });
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
            }
        }

        async function loadData() {
            if (!currentUser) return;
            
            try {
                const response = await fetch(`/api/data/${currentUser}`);
                const savedData = await response.json();
                
                if (savedData.rowCounter) {
                    rowCounter = savedData.rowCounter;
                }
                
                document.getElementById('tableBody').innerHTML = '';
                document.getElementById('mobileCards').innerHTML = '';
                
                if (savedData.rows && savedData.rows.length > 0) {
                    savedData.rows.forEach(item => {
                        const tbody = document.getElementById('tableBody');
                        const row = tbody.insertRow();
                        const id = parseInt(item.id.split('-')[1]);
                        row.id = item.id;
                        
                        row.innerHTML = `
                            <td><input type="text" value="${item.requisite}" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ä–µ–∫–≤–∏–∑–∏—Ç" onchange="saveData()"></td>
                            <td><input type="number" value="${item.income}" min="0" step="0.01" onchange="calculate(${id})"></td>
                            <td><input type="number" value="${item.incomePercent}" min="0" max="100" step="0.01" onchange="calculate(${id})"></td>
                            <td class="calculated">0.00</td>
                            <td><input type="number" value="${item.spent}" min="0" step="0.01" onchange="calculate(${id})"></td>
                            <td><input type="number" value="${item.buyback}" min="0" step="0.01" onchange="calculate(${id})"></td>
                            <td><input type="number" value="${item.buybackPercent}" min="0" max="100" step="0.01" onchange="calculate(${id})"></td>
                            <td class="calculated">0.00</td>
                            <td class="calculated">0.00</td>
                            <td><button class="delete-btn" onclick="deleteRow(${id})">–£–¥–∞–ª–∏—Ç—å</button></td>
                        `;
                        
                        const mobileCards = document.getElementById('mobileCards');
                        const card = document.createElement('div');
                        card.className = 'mobile-card';
                        card.id = `mobile-card-${id}`;
                        
                        card.innerHTML = `
                            <div class="mobile-card-header">
                                <h3>–û–ø–µ—Ä–∞—Ü–∏—è #${id}</h3>
                                <button class="delete-btn" onclick="deleteRow(${id})">–£–¥–∞–ª–∏—Ç—å</button>
                            </div>
                            <div class="mobile-card-row">
                                <label>–†–µ–∫–≤–∏–∑–∏—Ç:</label>
                                <input type="text" value="${item.requisite}" placeholder="–†–µ–∫–≤–∏–∑–∏—Ç" onchange="syncToTable(${id}, 0, this.value); saveData()">
                            </div>
                            <div class="mobile-card-row">
                                <label>–í—Ö–æ–¥ (‚ÇΩ):</label>
                                <input type="number" value="${item.income}" min="0" step="0.01" onchange="syncToTable(${id}, 1, this.value); calculate(${id})">
                            </div>
                            <div class="mobile-card-row">
                                <label>% –∑–∞—Ä–∞–±–æ—Ç–∫–∞:</label>
                                <input type="number" value="${item.incomePercent}" min="0" max="100" step="0.01" onchange="syncToTable(${id}, 2, this.value); calculate(${id})">
                            </div>
                            <div class="mobile-card-row">
                                <label>–ü–æ—Ç—Ä–∞—á–µ–Ω–æ (‚ÇΩ):</label>
                                <input type="number" value="${item.spent}" min="0" step="0.01" onchange="syncToTable(${id}, 4, this.value); calculate(${id})">
                            </div>
                            <div class="mobile-card-row">
                                <label>–í—ã—Ö–æ–¥ (‚ÇΩ):</label>
                                <input type="number" value="${item.buyback}" min="0" step="0.01" onchange="syncToTable(${id}, 5, this.value); calculate(${id})">
                            </div>
                            <div class="mobile-card-row">
                                <label>% –æ—Ç–∫—É–ø–∞:</label>
                                <input type="number" value="${item.buybackPercent}" min="0" max="100" step="0.01" onchange="syncToTable(${id}, 6, this.value); calculate(${id})">
                            </div>
                            <div class="mobile-card-result">
                                <div class="label">–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</div>
                                <div class="value" id="mobile-earned-${id}">0.00 ‚ÇΩ</div>
                            </div>
                        `;
                        
                        mobileCards.appendChild(card);
                        calculate(id);
                    });
                } else {
                    addRow();
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
                addRow();
            }
        }

        window.onload = function() {
            initTelegramAuth();
        };
    </script>
</body>
</html>
